[
  {
    "path": "posts/2022-02-08-anlise-espacial-da-mortalidade-infantil-em-sergipe-2010/",
    "title": "Análise espacial da mortalidade infantil em Sergipe, 2010 (post em construção)",
    "description": "Objetivo: demonstrar os passos necessários para analisar espacialmente dados de mortalidade infantil",
    "author": [
      {
        "name": "Daniel Marques",
        "url": "https://rdatamarques.netlify.app/"
      }
    ],
    "date": "2022-02-08",
    "categories": [],
    "contents": "\r\n\r\nbody {\r\ntext-align: justify}\r\nCarregamento de Pacotes\r\n\r\n\r\n#pacman -> utilizar função p_load (instala e carrega o pacote)\r\n#rio -> importar dados\r\n#here -> facilitar localização de arquivos\r\n#janitor -> função janitor para padronizar nomes das colunas\r\n#viridis -> utilizar cores que possam ser bem distinguidas \r\n#pelos daltônicos\r\n#tidyverse -> manipulação de dados\r\n#ggspatial -> inserir a seta para o norte no mapa\r\n#sf -> ler arquivos do tipo shapefile e transformá-los em simple feature\r\n#plotly -> criação de gráficos interativos\r\n#spdep -> utilizar funções poly2nb, nb2mat, mat2listw\r\n#RColorBrewer -> utilização de paleta de cores\r\n\r\nlibrary(pacman)\r\np_load(rio, here, janitor, viridis, tidyverse, viridis,\r\n       ggspatial, sf, plotly, spdep, gtools, \r\n       RColorBrewer, rayshader)\r\n# O pacote rayshader que está no CRAN, no momento, possui alguns bugs. A versão\r\n# que está no GitHub do autor do pacote já é mais funcional. Para instalá-la:\r\n# devtools::install_github(\"tylermorganwall/rayshader\")\r\n\r\n\r\n\r\nImportação de dados e limpeza\r\n\r\n\r\n# Importar dados sobre mortalidade infantil do IPEA\r\ndados_ipea <- import(\"C:/DataScienceUSP/Analise_espacial/Projeto/SE_IPEA.xlsx\", which = \"IDH_2010\")\r\n\r\n# Limpar os nomes das colunas, padronizando\r\ndados_ipea <- janitor::clean_names(dados_ipea)\r\n\r\n# Selecionar apenas as colunas necessárias\r\ndados_mort_inf <- dados_ipea %>% dplyr::select(codigo_do_municipio,\r\n                                          municipio,\r\n                                          mortalidade_infantil)\r\n\r\n# Ler o arquivo shapefile dos municípios de Sergipe,\r\n# transformando em simple feature\r\nsf_sergipe <- st_read(\"C:/DataScienceUSP/Analise_espacial/Projeto/SE_Municipios_2020.shp\")\r\n\r\n# Selecionar os 6 primeiros números do código do IBGE no \r\n# simple feature, para que possamos realizar o left_join \r\n# com a base de dados\r\nsf_sergipe$CD_MUN <- substring(sf_sergipe$CD_MUN, 1, 6)\r\n\r\n# Renomear a coluna codigo_do_municipio dos dados do IPEA\r\n# para CD_MUN, facilitando assim a união com o sf_sergipe\r\ndados_ipea <- dados_ipea %>%\r\n  rename(CD_MUN = codigo_do_municipio)\r\n\r\n# Transformar o tipo de dado CD_MUN de numérico para character\r\n# Com isso, garantimos o left_join com sucesso\r\ndados_ipea$CD_MUN <- as.character(dados_ipea$CD_MUN)\r\n\r\nsf_sergipe_ipea <-left_join(sf_sergipe, dados_ipea, \r\n                            by = \"CD_MUN\")\r\n\r\n\r\n\r\nGráfico em ggplot, demonstrando as regiões com maiores taxas de mortalidade infantil\r\n\r\n\r\ngg_mort_inf <- ggplot(data = sf_sergipe_ipea, \r\n                    aes(label = municipio)) + \r\n  geom_sf(aes(fill = mortalidade_infantil)) + \r\n  scale_fill_viridis(\"Mortes por 1000 nascidos vivos\") +\r\n  ggtitle(\"Taxa de Mortalidade Infantil em Sergipe, 2010\") +\r\n  theme_bw() +\r\n  annotation_north_arrow(width = unit(0.75, \"cm\"),\r\n                         height = unit(1.0, \"cm\"))\r\n\r\n# Exibição do gráfico em ggplot\r\ngg_mort_inf\r\n\r\n\r\n\r\n\r\nPreparação dos dados para análise da autocorrelação global\r\n\r\n\r\n# Estabelecendo vizinhanças por contiguidade, critério queen:\r\nvizinhos_queen <- poly2nb(pl = sf_sergipe,\r\n            queen = TRUE,\r\n            row.names = sf_sergipe$NM_MUN)\r\n\r\n# Estabelecendo a matriz de vizinhança, binária\r\nmatrizW_queen <- nb2mat(vizinhos_queen,\r\n       style = \"B\")\r\n\r\n# Renomeando linhas e colunas da matriz \r\nrownames(matrizW_queen) <- sf_sergipe$NM_MUN\r\ncolnames(matrizW_queen) <- sf_sergipe$NM_MUN\r\n\r\n# Transformando a matriz em um objeto do tipo listw para\r\n# realização do teste de autocorrelação global (I de Moran)\r\nlistW_queen <- mat2listw(matrizW_queen)\r\n\r\nmoran.test(x = sf_sergipe_ipea$mortalidade_infantil, \r\n           listw = listW_queen)\r\n\r\n# Constatando a existência de aglomerados espaciais\r\n# I de Moran = 0.28643100\r\n\r\n# Criando o diagrama de espalhamento de Moran\r\n# O lag.listw serve para calcular a variável \r\n# defasada espacialmente \r\nw_mort <- lag.listw(listW_queen, sf_sergipe_ipea$mortalidade_infantil)\r\n\r\n# Realizando o escore Z para geração do diagrama de espalhamento\r\n# de Moran\r\nw_mort_sca <- scale(w_mort)\r\nmort_inf_sca <- scale(sf_sergipe_ipea$mortalidade_infantil)\r\n\r\n# Criando o diagrama de espalhamento de Moran\r\nmoran_diag_mort_sca <- sf_sergipe_ipea %>%\r\n  ggplot(aes(label = NM_MUN)) +\r\n  geom_point(aes(x = mort_inf_sca, y = w_mort_sca),alpha=0.6, size=3) +\r\n  geom_smooth(aes(x = mort_inf_sca, y = w_mort_sca), method = \"lm\", se=FALSE) +\r\n  geom_vline(xintercept = mean(mort_inf_sca), lty = \"dashed\") +\r\n  geom_hline(yintercept = mean(w_mort_sca), lty = \"dashed\") +\r\n  annotate('text', x = -1.8, y = 2.5, label= 'Low-High') +\r\n  annotate('text', x = 1.8, y = 2.5, label= 'High-High') +\r\n  annotate('text', x = -1.8, y = -2, label= 'Low-Low') +\r\n  annotate('text', x = 1.8, y = -2, label= 'High-Low') +\r\n  xlab(\"Taxa de mortalidade infantil (observação de referência)\") +\r\n  ylab(\"Taxa de mortalidade infantil defasada espacialmente\") +\r\n  ggtitle(\"Diagrama de espalhamento de Moran\") +\r\n  theme_bw()\r\n\r\nmoran_diag_mort_sca\r\n\r\n\r\n\r\n\r\nPreparação dos dados para análise da autocorrelação local\r\n\r\n\r\n# Seguindo o proposto por Anselin (1995), devemos \r\n# padronizar em linha nossa matriz de pesos espaciais W:\r\nmatrizW_queen_linha <- nb2mat(vizinhos_queen,\r\n                        style = \"W\")\r\n\r\nlistW_queen_linha <- mat2listw(matrizW_queen_linha)\r\n\r\n# Calculando a autocorrelação local\r\nmoran_local_mort <- localmoran(x = sf_sergipe_ipea$mortalidade_infantil, \r\n           listw = listW_queen_linha)\r\n\r\n# Unindo o resultado do teste ao simple feature\r\nsf_sergipe_ipea_moran_local_mort <- cbind(sf_sergipe_ipea, \r\n                                     moran_local_mort)\r\n\r\n# Criando um objeto que reservará espaços para \r\n# conter, no futuro, os quadrantes AA, AB, BA e BB:\r\nquadrantes <- vector(mode = \"numeric\", length = nrow(moran_local_mort))\r\n\r\n# Criando um vetor que contenha o centro das observações da variável idh ao \r\n# redor de sua média:\r\ncentro_mort_inf <- sf_sergipe_ipea$mortalidade_infantil - \r\n  mean(sf_sergipe_ipea$mortalidade_infantil)\r\n\r\n# Criando um vetor que contenha o centro dos valores da Estatística Moran Local \r\n# em torno de sua média:\r\ncentro_moran_local_mort <- moran_local_mort[,1] - mean(moran_local_mort[,1])\r\n\r\n# Criando um objeto que guarde a significância a ser adotada:\r\nsig <- 0.05\r\n\r\n# Enquadrando nossas observações em seus respectivos quadrantes:\r\nquadrantes[centro_mort_inf > 0 & centro_moran_local_mort > 0] <- \"HH\"\r\nquadrantes[centro_mort_inf > 0 & centro_moran_local_mort < 0] <- \"HL\"\r\nquadrantes[centro_mort_inf < 0 & centro_moran_local_mort > 0] <- \"LH\"\r\nquadrantes[centro_mort_inf < 0 & centro_moran_local_mort < 0] <- \"LL\"\r\n\r\n# Ajustando a presença da observação em razão de sua significância estatística:\r\nquadrantes[moran_local_mort[,5] > sig] <- \"Estatisticamente_não_significante\"\r\n\r\n# Juntando o objeto quadrantes ao objeto \r\n# sf_sergipe_ipea_moran_local_mort\r\nsf_sergipe_ipea_moran_local_mort[\"quadrantes\"] <- factor(quadrantes)\r\n\r\n\r\n\r\nGeração do mapa de autocorrelação local\r\n\r\n\r\n\r\n\r\nComo resultado, observa-se que há aglomerados espaciais em Sergipe, municípios com altas taxas de mortalidade infantil, cercado de vizinhos com altas taxas (High-High), a exemplo de Santana de São Francisco, Pacatuba e Neópolis. Logo, medidas prioritárias devem ser adotadas para redução da mortalidade infantil nessa área. Além disso, há municípios com baixas taxas cercados de vizinhos com altas taxas, como Aracaju, Nossa Senhora do Socorro e São Cristóvão, demonstrando grande disparidade da mortalidade infantil, mesmo tão próximos geograficamente. Refletindo sobre essa proximidade, poderia se pensar em levar as boas práticas de uma região para outra, assim como algum tipo de auxílio financeiro que ajudasse no tratamento dessa realidade.\r\n\r\n\r\n\r\n\r\n",
    "preview": "posts/2022-02-08-anlise-espacial-da-mortalidade-infantil-em-sergipe-2010/anlise-espacial-da-mortalidade-infantil-em-sergipe-2010_files/figure-html5/unnamed-chunk-3-1.png",
    "last_modified": "2022-02-08T19:50:52-03:00",
    "input_file": {}
  },
  {
    "path": "posts/welcome/",
    "title": "Boas-vindas",
    "description": "Bem-vindo ao meu blog. Sou enfermeiro epidemiologista e cientista de dados em formação (MBA em Data Science e Analytics na USP/ESALQ). Nele publicarei meus projetos na área de Data Science!",
    "author": [
      {
        "name": "Daniel Marques",
        "url": "https://example.com/norajones"
      }
    ],
    "date": "2022-02-08",
    "categories": [],
    "contents": "\r\n\r\n\r\n\r\n",
    "preview": {},
    "last_modified": "2022-02-08T19:50:06-03:00",
    "input_file": {}
  }
]
